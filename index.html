<!doctype html>
<html lang="id" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Expense Tracker â€” Aplikasi tracking pengeluaran uang harian dengan penyimpanan lokal."
    />
    <title>Expense Tracker â€” Tracking Pengeluaran</title>
    <meta name="theme-color" content="#0f766e" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=Sora:wght@600;700;800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <!-- Header -->
    <header class="header">
      <div class="header-inner">
        <span class="header-icon">ğŸ’°</span>
        <div>
          <h1>Expense Tracker</h1>
          <p class="header-subtitle">
            Kelola pengeluaran harianmu dengan mudah
          </p>
        </div>
        <button
          class="btn-theme-toggle"
          id="btn-theme-toggle"
          title="Toggle dark mode"
          aria-label="Toggle dark mode"
        >
          <span class="theme-icon" id="theme-icon">ğŸŒ™</span>
        </button>
      </div>
    </header>

    <main class="container">
      <!-- Hero Section -->
      <section class="card hero-card">
        <span class="card-illus" aria-hidden="true">âœ¶</span>
        <div class="hero-content">
          <div class="hero-kicker">Ringkas Hari Ini</div>
          <h2 class="hero-title">Pengeluaran Hari Ini</h2>
          <div class="hero-value" id="today-amount">Rp 0</div>
          <div class="hero-meta">
            <span>Transaksi <strong id="today-count">0</strong></span>
            <span>Dominan <strong id="today-top">â€”</strong></span>
          </div>
          <p class="hero-note" id="today-note">Belum ada catatan hari ini.</p>
        </div>
        <div class="hero-graphic" aria-hidden="true">
          <div class="hero-orb"></div>
          <div class="hero-orb hero-orb-2"></div>
          <div class="hero-lines"></div>
        </div>
      </section>

      <!-- Form Section -->
      <section class="card glass form-card">
        <span class="card-illus" aria-hidden="true">â—ˆ</span>
        <h3 class="card-title">Tambah Pengeluaran</h3>
        <form id="expense-form" novalidate>
          <div class="form-grid">
            <div class="form-group">
              <label for="input-date">Tanggal</label>
              <input type="date" id="input-date" required />
              <small class="help-text" id="date-help" aria-live="polite"></small>
            </div>
            <div class="form-group">
              <label for="input-title">Nama Pengeluaran</label>
              <input
                type="text"
                id="input-title"
                placeholder="cth: Makan siang"
                required
              />
            </div>
            <div class="form-group">
              <label for="input-category">Kategori</label>
              <select id="input-category" required>
                <option value="" disabled selected>Pilih kategori</option>
                <option value="Makanan">ğŸ” Makanan</option>
                <option value="Transport">ğŸš— Transport</option>
                <option value="Belanja">ğŸ›’ Belanja</option>
                <option value="Hiburan">ğŸ¬ Hiburan</option>
                <option value="Kesehatan">ğŸ’Š Kesehatan</option>
                <option value="Pendidikan">ğŸ“š Pendidikan</option>
                <option value="Tagihan">ğŸ“„ Tagihan</option>
                <option value="Lainnya">ğŸ“¦ Lainnya</option>
              </select>
              <small class="help-text" id="category-help" aria-live="polite"></small>
            </div>
            <div class="form-group">
              <label for="input-amount">Nominal (Rp)</label>
              <input
                type="number"
                id="input-amount"
                placeholder="cth: 25000"
                min="0"
                step="1"
                inputmode="numeric"
                required
              />
              <small class="help-text" id="amount-help" aria-live="polite"></small>
            </div>
          </div>
          <div class="form-actions">
            <button type="submit" id="btn-submit" class="btn btn-primary">
              <span class="btn-icon">ï¼‹</span> Simpan
            </button>
            <button
              type="button"
              id="btn-cancel"
              class="btn btn-ghost"
              style="display: none"
            >
              Batal
            </button>
          </div>
        </form>
      </section>

      <!-- Summary Section -->
      <section class="card summary-card">
        <span class="card-illus" aria-hidden="true">â—‰</span>
        <div class="summary-grid">
          <div class="summary-item">
            <span class="summary-label">Total Pengeluaran</span>
            <span class="summary-value" id="total-amount">Rp 0</span>
          </div>
          <div class="summary-item">
            <span class="summary-label">Jumlah Transaksi</span>
            <span class="summary-value" id="total-count">0</span>
          </div>
          <div class="summary-item">
            <span class="summary-label">Rata-rata / Hari</span>
            <span class="summary-value" id="avg-per-day">Rp 0</span>
          </div>
          <div class="summary-item">
            <span class="summary-label">Kategori Teratas</span>
            <span class="summary-value summary-value-sm" id="top-category"
              >â€”</span
            >
          </div>
        </div>
      </section>

      <!-- Chart Section -->
      <section class="card glass chart-card">
        <span class="card-illus" aria-hidden="true">â—”</span>
        <h3 class="card-title">Grafik Pengeluaran</h3>
        <div class="chart-container">
          <canvas id="category-chart" width="280" height="280"></canvas>
          <div class="chart-legend" id="chart-legend"></div>
          <div class="chart-tooltip" id="chart-tooltip"></div>
        </div>
        <p class="chart-empty" id="chart-empty">
          Belum ada data untuk ditampilkan ğŸ“Š
        </p>
      </section>

      <!-- Filter -->
      <section class="card glass filter-card">
        <span class="card-illus" aria-hidden="true">â—³</span>
        <h3 class="card-title">Filter dan Aksi</h3>
        <div class="filter-layout">
          <div class="filter-fields">
            <div class="filter-group">
              <label for="filter-category">Kategori</label>
              <select id="filter-category">
                <option value="Semua">Semua</option>
                <option value="Makanan">ğŸ” Makanan</option>
                <option value="Transport">ğŸš— Transport</option>
                <option value="Belanja">ğŸ›’ Belanja</option>
                <option value="Hiburan">ğŸ¬ Hiburan</option>
                <option value="Kesehatan">ğŸ’Š Kesehatan</option>
                <option value="Pendidikan">ğŸ“š Pendidikan</option>
                <option value="Tagihan">ğŸ“„ Tagihan</option>
                <option value="Lainnya">ğŸ“¦ Lainnya</option>
              </select>
            </div>
            <div class="filter-group">
              <label for="filter-month">Bulan</label>
              <input type="month" id="filter-month" />
            </div>
            <div class="filter-group">
              <label for="filter-sort">Urutkan</label>
              <select id="filter-sort">
                <option value="date-desc">Tanggal terbaru</option>
                <option value="date-asc">Tanggal terlama</option>
                <option value="amount-desc">Nominal tertinggi</option>
                <option value="amount-asc">Nominal terendah</option>
              </select>
            </div>
            <div class="filter-group filter-group-undo">
              <label>Riwayat</label>
              <div class="undo-inline">
                <span class="undo-indicator" id="undo-indicator">Undo: 0</span>
                <button class="btn btn-ghost btn-sm" id="btn-undo" type="button" disabled>
                  Undo
                </button>
              </div>
            </div>
          </div>
          <div class="filter-actions">
            <button class="btn btn-ghost btn-sm" id="btn-reset-filter" type="button">
              Reset Filter
            </button>
            <button class="btn btn-accent btn-sm" id="btn-export-csv" type="button">
              ğŸ“¥ Export CSV
            </button>
            <button class="btn btn-ghost btn-sm" id="btn-export-json" type="button">
              ğŸ§¾ Export JSON
            </button>
            <button class="btn btn-ghost btn-sm" id="btn-import-json" type="button">
              ğŸ“¤ Import JSON
            </button>
            <input type="file" id="input-import-json" accept="application/json" hidden />
            <button class="btn btn-split btn-sm" id="btn-open-split" type="button">
              ğŸ§¾ Split Bill
            </button>
          </div>
        </div>
      </section>

      <!-- Table Section -->
      <section class="card glass table-card">
        <span class="card-illus" aria-hidden="true">â–¦</span>
        <h3 class="card-title">Daftar Pengeluaran</h3>
        <p class="render-state" id="render-state" aria-live="polite"></p>
        <div class="table-wrapper">
          <table id="expense-table">
            <thead>
              <tr>
                <th>Tanggal</th>
                <th>Nama</th>
                <th>Kategori</th>
                <th class="text-right">Nominal</th>
                <th class="text-center">Aksi</th>
              </tr>
            </thead>
            <tbody id="expense-tbody">
              <!-- Rows rendered via JS -->
            </tbody>
          </table>
        </div>
        <p class="empty-state" id="empty-state">
          Belum ada pengeluaran. Tambahkan transaksi pertama dari form di atas.
        </p>
      </section>
    </main>

    <!-- Confirm Delete Modal -->
    <div class="modal-overlay" id="modal-overlay">
      <div class="modal glass" role="dialog" aria-modal="true" aria-labelledby="modal-delete-title">
        <div class="modal-icon">âš ï¸</div>
        <p class="modal-text" id="modal-delete-title">Yakin ingin menghapus pengeluaran ini?</p>
        <div class="modal-actions">
          <button class="btn btn-danger" id="btn-confirm-delete" type="button">Hapus</button>
          <button class="btn btn-ghost" id="btn-cancel-delete" type="button">Batal</button>
        </div>
      </div>
    </div>

    <!-- Split Bill Modal -->
    <div class="modal-overlay" id="split-overlay">
      <div class="modal glass split-modal" role="dialog" aria-modal="true" aria-labelledby="split-title">
        <div class="split-header">
          <h2 id="split-title">ğŸ§¾ Split Bill</h2>
          <button class="btn-close" id="btn-close-split" aria-label="Close" type="button">&times;</button>
        </div>

        <!-- Split Form -->
        <div class="split-body" id="split-form-view">
          <div class="split-form-grid">
            <div class="form-group">
              <label for="split-bill-name">Nama Bill</label>
              <input type="text" id="split-bill-name" placeholder="cth: Makan bersama" />
            </div>
            <div class="form-group">
              <label for="split-total">Total Tagihan (Rp)</label>
              <input type="number" id="split-total" placeholder="cth: 250000" min="0" step="1" inputmode="numeric" />
            </div>
          </div>

          <div class="split-mode-toggle">
            <button class="split-mode-btn active" data-mode="equal" id="mode-equal" type="button">âš–ï¸ Bagi Rata</button>
            <button class="split-mode-btn" data-mode="custom" id="mode-custom" type="button">âœï¸ Custom</button>
          </div>

          <div class="split-participants">
            <div class="split-participants-header">
              <label>Peserta</label>
              <button class="btn btn-sm btn-primary" id="btn-add-person" type="button">ï¼‹ Tambah</button>
            </div>
            <div class="split-person-list" id="split-person-list">
              <!-- Dynamic person rows -->
            </div>
          </div>

          <div class="split-form-actions">
            <button class="btn btn-primary" id="btn-calculate-split" type="button">ğŸ§® Hitung Split</button>
          </div>
        </div>

        <!-- Split Results -->
        <div class="split-body split-results" id="split-results-view" style="display:none">
          <div class="split-result-summary" id="split-result-summary"></div>
          <div class="split-result-list" id="split-result-list"></div>
          <div class="split-form-actions">
            <button class="btn btn-primary" id="btn-save-split" type="button">ğŸ’¾ Simpan ke Pengeluaran</button>
            <button class="btn btn-ghost" id="btn-back-split" type="button">â† Kembali</button>
          </div>
        </div>

        <!-- Split History -->
        <div class="split-history" id="split-history">
          <h3 class="split-history-title">ğŸ“‹ Riwayat Split</h3>
          <div id="split-history-list" class="split-history-list"></div>
        </div>
      </div>
    </div>

    <!-- Import JSON Modal -->
    <div class="modal-overlay" id="import-overlay">
      <div class="modal glass import-modal" role="dialog" aria-modal="true" aria-labelledby="import-title">
        <div class="modal-icon">ğŸ“¤</div>
        <h2 class="modal-text" id="import-title">Impor JSON</h2>
        <p class="modal-subtext">Pilih mode impor untuk data JSON.</p>
        <div class="import-options">
          <label class="radio-option">
            <input type="radio" name="import-mode" value="replace" checked />
            <span class="radio-label">
              Ganti semua data
            </span>
            <span class="radio-desc">Hapus data lama, gunakan data dari file.</span>
          </label>
          <label class="radio-option">
            <input type="radio" name="import-mode" value="merge-id" />
            <span class="radio-label">
              Gabung (berdasarkan ID)
            </span>
            <span class="radio-desc">Tambahkan item baru yang IDâ€‘nya belum ada.</span>
          </label>
          <label class="radio-option">
            <input type="radio" name="import-mode" value="merge-content" />
            <span class="radio-label">
              Gabung (berdasarkan konten)
            </span>
            <span class="radio-desc">Cegah duplikat berdasarkan tanggal+judul+kategori+nominal.</span>
          </label>
        </div>
        <div class="modal-actions">
          <button class="btn btn-primary" id="btn-confirm-import" type="button">Impor</button>
          <button class="btn btn-ghost" id="btn-cancel-import" type="button">Batal</button>
        </div>
      </div>
    </div>

    <!-- Import Summary Modal -->
    <div class="modal-overlay" id="import-summary-overlay">
      <div class="modal glass import-summary-modal" role="dialog" aria-modal="true" aria-labelledby="import-summary-title">
        <div class="modal-icon">âœ…</div>
        <h2 class="modal-text" id="import-summary-title">Ringkasan Impor</h2>
        <div class="import-summary">
          <div class="import-summary-row">
            <span>Mode</span>
            <span id="import-summary-mode">â€”</span>
          </div>
          <div class="import-summary-row">
            <span>Ditambahkan</span>
            <span id="import-summary-added">0</span>
          </div>
          <div class="import-summary-row">
            <span>Dilewati</span>
            <span id="import-summary-skipped">0</span>
          </div>
        </div>
        <div class="modal-actions">
          <button class="btn btn-primary" id="btn-close-import-summary" type="button">OK</button>
        </div>
      </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toast-container" aria-live="polite" aria-atomic="true"></div>

    <footer class="footer">
      <p>
        &copy; 2026 Expense Tracker &mdash; Data disimpan di browser
        (localStorage)
      </p>
    </footer>

    <script src="script.js"></script>
  </body>
</html>
